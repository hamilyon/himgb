-- GuessEnglishEnc.hs
module GuessEnglishEnc

where
import Data.Map as Map

-- credit for frequency goes to Charles SDudu (iwin_1 at hotmail.com)
frequency :: (Ord a) => [a] -> Map.Map a Int
frequency xs = foldl f Map.empty xs
    where f m x = let
                m' = Map.insertWith (+) x 1 m
                Just v = Map.lookup x m'
                in seq v m'

normalize :: Map.Map Char Int -> Map.Map Char Double
normalize frequencies = Map.map f frequencies
    where f count = (fromIntegral count) / n
          n = norm frequencies

norm :: Map.Map Char Int -> Double
norm frequencies = (Map.fold (\a b -> (fromIntegral a**2)+b) 0 frequencies) ** 0.5

dropSpace = Map.delete ' '

freq = normalize . dropSpace . frequency

correlation :: Map.Map Char Double -> Map.Map Char Double -> Double
correlation a b = (Map.fold (+) 0 intersectProduct) 
    where intersectProduct = Map.intersectionWith (\a b -> a * b) a b

typicalEnglish :: Map.Map Char Double
typicalEnglish = Map.fromList [('\n',3.5987338165738035e-2),
    (' ',0.9327924684054336),('!',2.1042243868835806e-4),('"',4.996576453218102e-3),('#',2.2190002625317758e-4),('$',6.325426035722763e-4),('%',1.9384370109472985e-4),('&',1.6961323845788862e-4),('\'',5.002952890754113e-3),('(',6.005328871415019e-3),(')',5.992575996342997e-3),('*',5.85356965805796e-4),('+',1.259984057115744e-3),(',',1.696642499581767e-2),('-',1.2082073843233359e-2),('.',2.4322283337359786e-2),('/',5.134307503995936e-3),('0',6.398117423633287e-3),('1',7.001328414539913e-3),('2',5.4799104184477246e-3),('3',2.558226739447553e-3),('4',2.4791589140010185e-3),('5',1.6221657091611602e-3),('6',1.2370288819861049e-3),('7',1.103123693729877e-3),('8',1.9856226487137787e-3),('9',2.5441985768683293e-3),(':',9.284093052431797e-3),(';',3.940638397254705e-4),('<',1.087820243643451e-3),('=',4.2505332615048325e-3),('>',5.7821535576546386e-3),('?',4.884351152584311e-4),('@',5.10115002880868e-5),('A',2.7278399779054417e-3),('B',2.731665840427048e-3),('C',5.442927080738862e-3),('D',2.5760807645483835e-3),('E',2.38606292597526e-3),('F',2.7048848027758027e-3),('G',1.5163168460633801e-3),('H',3.207348080613458e-3),('I',5.315398330018645e-3),('J',1.2867650947669897e-3),('K',2.3465290132519928e-4),('L',2.632193414865279e-3),('M',3.405017644229794e-3),('N',6.736068613041862e-3),('O',2.893627353841724e-3),('P',3.538922832486022e-3),('Q',2.1552358871716672e-4),('R',2.2687364753126603e-3),('S',6.741169763070671e-3),('T',6.331802473258774e-3),('U',1.319922569954246e-3),('V',6.580483537163197e-4),('W',3.030083117112356e-3),('X',2.3592818883240145e-4),('Y',3.2264773932214904e-4),('Z',6.503966286731067e-5),('[',2.670452040081344e-3),('\\',8.17459292116591e-4),(']',2.65642387750212e-3),('^',1.1222530063379096e-4),('_',1.0929213936722597e-3),('`',8.48066192289443e-4),('a',0.10727590981833934),('b',1.6810839919939004e-2),('c',5.3446024139335746e-2),('d',4.389539599789869e-2),('e',0.1713093708424675),('f',3.112466690077616e-2),('g',2.7347265304443334e-2),('h',5.520081974924593e-2),('i',9.55011802643417e-2),('j',6.988575539467891e-4),('k',1.1139636375410955e-2),('l',6.361389143425865e-2),('m',4.837037986067111e-2),('n',0.10073751076891381),('o',0.10910084624114565),('p',3.533439096205052e-2),('q',2.1131513994339956e-3),('r',8.636757113775977e-2),('s',9.255399083519748e-2),('t',0.13535519015191672),('u',4.09609594438265e-2),('v',1.2121607755956627e-2),('w',2.19795801866294e-2),('x',6.991126114482296e-3),('y',2.2397874488991713e-2),('z',1.3428777450838851e-3),('{',4.0044027726148136e-4),('|',7.179868665548217e-4),('}',3.787603896390445e-4),('~',8.799483799694973e-5),('\201',1.27528750720217e-6),('\225',3.82586252160651e-6),('\228',1.27528750720217e-6),('\233',1.020230005761736e-5),('\237',1.27528750720217e-6),('\239',1.27528750720217e-6),('\243',1.27528750720217e-6),('\246',5.10115002880868e-6),('\250',2.55057501440434e-6),('\252',2.55057501440434e-6),('\259',1.27528750720217e-6),('\262',1.27528750720217e-6),('\269',1.27528750720217e-6),('\283',1.27528750720217e-6),('\322',2.55057501440434e-6),('\353',5.10115002880868e-6),('\537',1.27528750720217e-6),('\539',3.82586252160651e-6),('\955',2.55057501440434e-6),('\8211',3.82586252160651e-6),('\8212',8.544426298254539e-5),('\8216',6.37643753601085e-6),('\8217',2.933161266564991e-5),('\8220',6.312673160650742e-4),('\8221',6.312673160650742e-4),('\8226',3.82586252160651e-6),('\8800',1.27528750720217e-6)]

